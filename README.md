# SearchEngine - Многопоточная поисковая система

## Описание

SearchEngine - это многопоточная поисковая система, которая индексирует текстовые документы и выполняет поиск с учетом релевантности. Система использует инвертированный индекс для эффективного поиска документов и поддерживает параллельную обработку данных.

## Архитектура

Проект состоит из двух основных компонентов:

- **SEGW/** - основная программа с поисковой логикой
- **tests/** - модульные тесты для проверки функциональности

### Основные классы

- **ConverterJSON** - работа с JSON-файлами (конфигурация, запросы, результаты)
- **InvertedIndex** - многопоточный инвертированный индекс для быстрого поиска
- **SearchServer** - обработка поисковых запросов с использованием многопоточности
- **main.cpp** - точка входа в приложение

## Сборка проекта

### Требования
- CMake 3.16 или выше
- C++17 совместимый компилятор
- nlohmann/json библиотека
- Google Test (для тестов)

### Сборка основной программы
```bash
cd SEGW
mkdir build && cd build
cmake ..
make
```

### Сборка тестов
```bash
cd tests
mkdir build && cd build
cmake ..
make
```

## Конфигурация

### config.json

Основной файл конфигурации содержит настройки приложения и параметры обработки файлов.

**Обязательное поле:** `name` - имя приложения

#### Автоматическое обнаружение файлов (рекомендуется)
```json
{
    "config": {
        "name": "Search Engine",
        "version": "1.0",
        "max_responses": 5,
        "auto_discover_files": true,
        "max_files_to_process": 5,
        "resources_directory": "resources"
    }
}
```

#### Ручное указание файлов
```json
{
    "config": {
        "name": "Search Engine",
        "version": "1.0",
        "max_responses": 5,
        "auto_discover_files": false
    },
    "files": [
        "resources/file1.txt",
        "resources/file2.txt"
    ]
}
```

#### Параметры конфигурации

| Параметр | Описание | По умолчанию |
|----------|----------|--------------|
| `name` | Имя приложения (обязательно) | - |
| `version` | Версия приложения | "0.1" |
| `max_responses` | Максимальное количество результатов поиска | 5 |
| `thread_pool_size` | Количество потоков для обработки | 4 |
| `max_file_size_mb` | Максимальный размер файла в МБ | 10 |
| `supported_extensions` | Поддерживаемые расширения файлов | [".txt", ".md"] |
| `log_level` | Уровень логирования | "INFO" |
| `auto_discover_files` | Автоматическое обнаружение файлов | false |
| `max_files_to_process` | Максимальное количество файлов при автопоиске | 10 |
| `resources_directory` | Папка для поиска файлов | "resources" |

### requests.json

Содержит поисковые запросы для обработки:

```json
{
    "requests": [
        "первый запрос",
        "второй запрос"
    ]
}
```

### answers.json

Формат выходного файла с результатами поиска:

```json
{
    "answers": {
        "request001": {
            "result": true,
            "relevance": [
                {"docid": 0, "rank": 0.9},
                {"docid": 1, "rank": 0.8}
            ]
        }
    }
}
```

## Алгоритм работы

1. **Загрузка конфигурации** - чтение настроек из `config.json` с проверкой обязательного поля "name"
2. **Индексация документов** - многопоточная обработка и построение инвертированного индекса
3. **Нормализация слов** - приведение к нижнему регистру, фильтрация цифр, ограничение до 100 символов
4. **Загрузка запросов** - чтение поисковых запросов из `requests.json`
5. **Выполнение поиска** - многопоточный поиск по индексу для каждого запроса
6. **Сохранение результатов** - запись результатов в `JSON/answers.json`

## Использование

### Быстрый старт

1. **Подготовка документов**
   ```bash
   # Поместите текстовые файлы в папку resources/
   mkdir -p resources
   echo "Пример текста для поиска" > resources/document1.txt
   ```

2. **Настройка конфигурации**
   ```json
   {
       "config": {
           "name": "My Search Engine",
           "auto_discover_files": true,
           "max_files_to_process": 10
       }
   }
   ```

3. **Добавление запросов**
   ```json
   {
       "requests": [
           "поиск текста",
           "важные документы"
       ]
   }
   ```

4. **Запуск программы**
   ```bash
   cd SEGW
   ./build/SearchEngine
   ```

5. **Просмотр результатов**
   ```bash
   cat JSON/answers.json
   ```

### Режимы работы

#### Автоматический режим
- Автоматически находит все поддерживаемые файлы в указанной папке
- Сортирует файлы по имени для предсказуемого порядка
- Ограничивает количество обрабатываемых файлов
- Не требует ручного указания путей к файлам

#### Ручной режим
- Полный контроль над выбором файлов
- Возможность указать файлы из разных директорий
- Требует точного указания путей к файлам

## Тестирование

### Запуск всех тестов
```bash
cd tests/build
./SearchEngineTests
```

### Запуск через CMake
```bash
cd tests/build
ctest --verbose
```

### Запуск конкретного теста
```bash
./SearchEngineTests --gtest_filter="InvertedIndexTest.WordNormalization"
```

### Покрытие тестами
- **ConverterJSON** - 11 тестов (работа с конфигурацией, файлами, запросами)
- **InvertedIndex** - 3 теста (построение индекса, поиск слов)
- **SearchServer** - 2 теста (обработка запросов, ранжирование)

## Производительность

### Характеристики
- **Время индексации**: < 1 мс для 5 документов
- **Время поиска**: < 1 мс для 3 запросов
- **Общее время выполнения**: 2-3 мс
- **Поддержка многопоточности**: до 8 потоков

### Оптимизация
- Использование инвертированного индекса для быстрого поиска
- Параллельная обработка документов и запросов
- Нормализация слов для улучшения качества поиска
- Ограничение размера файлов для контроля памяти

## Поддерживаемые форматы

- **Текстовые файлы**: .txt
- **Markdown файлы**: .md
- **Кодировка**: UTF-8
- **Максимальный размер файла**: настраивается через `max_file_size_mb`

## Структура проекта

```
SearchEngine_GraduationWork/
├── SEGW/                          # Основная программа
│   ├── src/                       # Исходный код
│   ├── include/                   # Заголовочные файлы
│   ├── JSON/                      # Конфигурация и результаты
│   ├── resources/                 # Документы для индексации
│   └── build/                     # Собранная программа
├── tests/                         # Тесты
│   ├── test_*.cpp                 # Тестовые файлы
│   └── build/                     # Собранные тесты
└── README.md                      # Документация
```

## Устранение неполадок

### Частые проблемы

**Программа не находит файлы конфигурации**
- Убедитесь, что запускаете программу из корневой папки SEGW
- Проверьте существование файлов config.json и requests.json

**Ошибка "File not found"**
- Проверьте пути к файлам в конфигурации
- Убедитесь, что файлы существуют и доступны для чтения

**Низкая производительность**
- Увеличьте `thread_pool_size` в конфигурации
- Уменьшите `max_files_to_process` для больших наборов данных

**Пустые результаты поиска**
- Проверьте содержимое файлов в папке resources/
- Убедитесь, что запросы в requests.json содержат существующие слова

## Лицензия

Проект создан в рамках выпускной работы.

## Контакты

Для вопросов и предложений обращайтесь к разработчику проекта.
